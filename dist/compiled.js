(()=>{"use strict";var t={769:function(t,e,i){var s=this&&this.__assign||function(){return s=Object.assign||function(t){for(var e,i=1,s=arguments.length;i<s;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},s.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var n=i(728),o=i(471),h=i(593),a={direction:"right",isOver:!1,foodPos:void 0,score:0,start:{x:0,y:0}};(new(function(){function t(){this.positions=[],this.segmentWidth=20,this.canvas=window.document.getElementById("canvas"),this.score=window.document.getElementById("score"),this.fps=7,this.state=s({},a),this.init()}return t.prototype.init=function(){window.addEventListener("keydown",this.keydown.bind(this),!1),this.stage=new o.Stage(this.canvas),this.snake=new n.Snake,this.positions=[];for(var t=0;t<this.canvas.height-this.segmentWidth;t+=this.segmentWidth)for(var e=0;e<this.canvas.width-this.segmentWidth;e+=this.segmentWidth)this.positions.push({x:e,y:t});this.snake.push(),this.loop()},t.prototype.updateSnakePosition=function(){var t=this.state.start.y>this.canvas.height+this.segmentWidth,e=this.state.start.y<-this.segmentWidth,i=this.state.start.x>this.canvas.width+this.segmentWidth,s=this.state.start.x<-this.segmentWidth;if(i||s||e||t)i?this.state.start.x=0:s?this.state.start.x=this.canvas.width:e?this.state.start.y=this.canvas.height-this.segmentWidth:t&&(this.state.start.y=0);else switch(this.state.direction){case"left":this.state.start.x-=this.segmentWidth;break;case"right":this.state.start.x+=this.segmentWidth;break;case"up":this.state.start.y-=this.segmentWidth;break;case"down":this.state.start.y+=this.segmentWidth}this.snake.updatePosition(this.state.start.x,this.state.start.y)},t.prototype.checkCollision=function(){var t=this.snake.getSegmentPositions();new Set(t.map((function(t){return"".concat(t.x,"|").concat(t.y)}))).size!==t.length&&(this.state.isOver=!0),this.snake.head.position.x===this.state.foodPos.x&&this.snake.head.position.y===this.state.foodPos.y&&(this.state.foodPos=this.getRandomPosition(),this.snake.push(),this.state.score++,this.updateScore())},t.prototype.updateScore=function(){this.score.innerHTML="Score: ".concat(this.state.score)},t.prototype.reset=function(){this.state=s({},a),this.updateScore(),this.init()},t.prototype.draw=function(){void 0===this.state.foodPos&&(this.state.foodPos=this.getRandomPosition()),this.checkCollision(),this.updateSnakePosition(),this.stage.render(this.snake,this.state)},t.prototype.loop=function(){var t=this;this.state&&(this.state.isOver?this.reset():setTimeout((function(){requestAnimationFrame(t.loop.bind(t)),t.draw()}),1e3/this.fps))},t.prototype.keydown=function(t){var e=h.keyMap[t.key];("left"===e&&"right"!==this.state.direction||"right"===e&&"left"!==this.state.direction||"up"===e&&"down"!==this.state.direction||"down"===e&&"up"!==this.state.direction)&&(this.state.direction=e)},t.prototype.getRandomPosition=function(){var t=this.snake.getSegmentPositions(),e=this.positions.filter((function(e){return!t.includes(e)}));return e[Math.floor(Math.random()*e.length)]},t}())).init()},600:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Segment=void 0;e.Segment=function(){this.position={x:0,y:0},this.next=null,this.prev=null}},728:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Snake=void 0;var s=i(600),n=function(){function t(){this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(){var t=new s.Segment;if(this.head){var e=this.tail;e.next=t,t.prev=e}else this.head=t;return this.tail=t,this.length++,this},t.prototype.updatePosition=function(t,e){var i=this.head.position.x,s=this.head.position.y,n=this.head;if(n)for(;n;){if(n===this.head)n.position.x=t,n.position.y=e;else{var o=n.position.x,h=n.position.y;n.position.x=i,n.position.y=s,i=o,s=h}n=n.next}},t.prototype.getSegmentPositions=function(){for(var t=this.head,e=[];t;){var i=t.position,s=i.x,n=i.y;e.push({x:s,y:n}),t=t.next}return e},t}();e.Snake=n},471:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=void 0;var i=function(){function t(t){this.canvas=t,this.ctx=t.getContext("2d"),this.segmentWidth=20,this.ctx.lineWidth=5,this.start={x:0,y:0}}return t.prototype.render=function(t,e){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.renderSnake(t),this.renderFood(e.foodPos)},t.prototype.renderSnake=function(t){for(var e=t.head;e;){var i=e.position;this.ctx.fillStyle="#000000",this.ctx.fillRect(i.x,i.y,this.segmentWidth,this.segmentWidth),e=e.next}},t.prototype.renderFood=function(t){this.ctx.fillStyle="#FF0000",this.ctx.fillRect(t.x,t.y,this.segmentWidth,this.segmentWidth),this.ctx.stroke()},t}();e.Stage=i},593:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.keyMap=void 0,e.keyMap={ArrowRight:"right",ArrowLeft:"left",ArrowUp:"up",ArrowDown:"down"}}},e={};!function i(s){var n=e[s];if(void 0!==n)return n.exports;var o=e[s]={exports:{}};return t[s].call(o.exports,o,o.exports,i),o.exports}(769)})();